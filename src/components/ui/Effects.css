/* Quest Target Pulsing Animation */
.quest-pulse {
  animation: questPulse 2s ease-in-out infinite;
}

@keyframes questPulse {
  0% {
    r: 20;
    opacity: 0.6;
  }
  50% {
    r: 28;
    opacity: 0.3;
  }
  100% {
    r: 20;
    opacity: 0.6;
  }
}

/* Weather Layers Container */
.weather-container {
  /* Position removed here as it's handled by inline styles in foreignObject */
  /* If used outside, these defaults apply */
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 20;
}

.weather-layer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-size: cover;
  opacity: 0;
  transition: opacity 5s ease-in-out;
  will-change: opacity;
}

/* Active state */
.weather-layer.active {
  opacity: 1;
}

/* Winter: Snow Effect - Multiple layers for natural look */
.weather-layer.snow {
  /* Layer 1: Large distant flakes */
  /* Layer 2: Medium flakes */
  /* Layer 3: Small close flakes */
  /* Multiple sizes and positions for organic feel */
  background-image: 
    /* Large sparse flakes - slow */
    radial-gradient(3px 3px at 50px 80px, rgba(255,255,255,0.9), rgba(0,0,0,0)),
    radial-gradient(3px 3px at 180px 200px, rgba(255,255,255,0.85), rgba(0,0,0,0)),
    radial-gradient(2.5px 2.5px at 320px 120px, rgba(255,255,255,0.8), rgba(0,0,0,0)),
    radial-gradient(3px 3px at 450px 300px, rgba(255,255,255,0.9), rgba(0,0,0,0)),
    /* Medium flakes */
    radial-gradient(2px 2px at 20px 40px, rgba(255,255,255,0.8), rgba(0,0,0,0)),
    radial-gradient(2px 2px at 100px 150px, rgba(255,255,255,0.75), rgba(0,0,0,0)),
    radial-gradient(2px 2px at 220px 60px, rgba(255,255,255,0.8), rgba(0,0,0,0)),
    radial-gradient(2px 2px at 350px 220px, rgba(255,255,255,0.7), rgba(0,0,0,0)),
    radial-gradient(2px 2px at 480px 90px, rgba(255,255,255,0.8), rgba(0,0,0,0)),
    radial-gradient(2px 2px at 150px 280px, rgba(255,255,255,0.75), rgba(0,0,0,0)),
    /* Small dense flakes */
    radial-gradient(1.5px 1.5px at 30px 20px, rgba(255,255,255,0.6), rgba(0,0,0,0)),
    radial-gradient(1.5px 1.5px at 80px 100px, rgba(255,255,255,0.55), rgba(0,0,0,0)),
    radial-gradient(1.5px 1.5px at 140px 50px, rgba(255,255,255,0.6), rgba(0,0,0,0)),
    radial-gradient(1.5px 1.5px at 200px 180px, rgba(255,255,255,0.5), rgba(0,0,0,0)),
    radial-gradient(1.5px 1.5px at 270px 130px, rgba(255,255,255,0.6), rgba(0,0,0,0)),
    radial-gradient(1.5px 1.5px at 330px 70px, rgba(255,255,255,0.55), rgba(0,0,0,0)),
    radial-gradient(1.5px 1.5px at 400px 160px, rgba(255,255,255,0.6), rgba(0,0,0,0)),
    radial-gradient(1px 1px at 60px 250px, rgba(255,255,255,0.5), rgba(0,0,0,0)),
    radial-gradient(1px 1px at 420px 30px, rgba(255,255,255,0.45), rgba(0,0,0,0)),
    radial-gradient(1px 1px at 500px 200px, rgba(255,255,255,0.5), rgba(0,0,0,0));
  /* Large pattern size to reduce visible tiling */
  background-size: 550px 350px;
  animation: snowfall 25s linear infinite;
}

.weather-layer.snow.active {
    opacity: 0.7;
}

/* Seamless snow animation - end position = start position after one tile */
@keyframes snowfall {
  0% { 
    background-position: 0px 0px;
  }
  100% { 
    /* Move exactly one tile width/height for seamless loop */
    background-position: 550px 350px; 
  }
}

/* Summer: Pollen/Dust Effect */
.weather-layer.pollen {
  background-image: 
    radial-gradient(1.5px 1.5px at 10px 10px, #ffd700, rgba(0,0,0,0)),
    radial-gradient(1.5px 1.5px at 30px 50px, #ffd700, rgba(0,0,0,0)),
    radial-gradient(1px 1px at 80px 120px, #fff, rgba(0,0,0,0));
  background-size: 300px 300px;
  animation: pollen 20s linear infinite;
}

.weather-layer.pollen.active {
    opacity: 0.3;
}

@keyframes pollen {
  0% { background-position: 0px 0px; }
  100% { background-position: 50px -50px; }
}

/* Autumn: Falling Leaves */
.weather-layer.leaves {
  background-image: 
    radial-gradient(2px 2px at 15px 15px, #d35400, rgba(0,0,0,0)),
    radial-gradient(2px 2px at 45px 85px, #e67e22, rgba(0,0,0,0)),
    radial-gradient(2px 2px at 85px 35px, #c0392b, rgba(0,0,0,0));
  background-size: 250px 250px;
  animation: leaves 15s linear infinite;
}

.weather-layer.leaves.active {
    opacity: 0.4;
}

@keyframes leaves {
  0% { background-position: 0px 0px; }
  100% { background-position: 50px 200px; }
}

/* Spring: VERY Subtle Petals */
.weather-layer.petals {
  background-image: 
    radial-gradient(2px 2px at 10px 10px, #ffb7b2, rgba(0,0,0,0)), 
    radial-gradient(2px 2px at 80px 60px, #ffdac1, rgba(0,0,0,0));
  background-size: 300px 300px; /* Bigger size = sparser particles */
  animation: petals 15s linear infinite;
}

.weather-layer.petals.active {
    opacity: 0.3;
}

@keyframes petals {
  0% { background-position: 0px 0px; }
  50% { background-position: 20px 30px; }
  100% { background-position: 40px 60px; }
}

/* Map Transitions */
.map-path {
    transition: fill 5s ease-in-out, stroke 0.3s ease;
}

stop {
    transition: stop-color 5s ease-in-out;
}

/* War Fog Effects */
.war-fog-layer path {
    animation: warPulse 2s ease-in-out infinite;
}

@keyframes warPulse {
    0%, 100% { 
        opacity: 0.7;
        filter: blur(0px);
    }
    50% { 
        opacity: 0.5;
        filter: blur(1px);
    }
}

/* Contested Territory Pulse */
@keyframes contestedPulse {
    0%, 100% {
        stroke-opacity: 0.9;
        stroke-dashoffset: 0;
    }
    50% {
        stroke-opacity: 0.5;
        stroke-dashoffset: 12;
    }
}
